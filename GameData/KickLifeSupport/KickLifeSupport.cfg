// ---------------------------------------------------------
// 1. SETUP: Add the Module to all crewed parts
// ---------------------------------------------------------
@PART[*]:HAS[#CrewCapacity[>0]]:FINAL
{
    MODULE
    {
        name = KickLifeSupportModule
        scrubberHeat = 0.25
    }
}

// =========================================================
// THERMAL MODES
// =========================================================
@PART[*]:HAS[@MODULE[ModuleCommand],#CrewCapacity[1],@MODULE[KickLifeSupportModule]]:FINAL
{
    @MODULE[KickLifeSupportModule]
    {
        avionicsEnabled = true
        avionicsECRate = 0.2
        avionicsHeat = 0.2
        sasECRate = 0.1
        sasHeat = 0.1
        rcsECRate = 0.1
        rcsHeat = 0.1
        // Fan and control electronics
        systemECRate = 0.03
        systemHeat = 0.03
        heaterECRate = 2.0
        heaterHeat = 2.0
    }
}

@PART[*]:HAS[@MODULE[ModuleCommand],#CrewCapacity[2],@MODULE[KickLifeSupportModule]]:FINAL
{
    @MODULE[KickLifeSupportModule]
    {
        avionicsEnabled = true
        avionicsECRate = 0.2
        avionicsHeat = 0.2
        sasECRate = 0.1
        sasHeat = 0.1
        rcsECRate = 0.1
        rcsHeat = 0.1
        // Fan and control electronics
        systemECRate = 0.03
        systemHeat = 0.03
        heaterECRate = 4.0
        heaterHeat = 4.0
    }
}

@PART[*]:HAS[@MODULE[ModuleCommand],#CrewCapacity[3],@MODULE[KickLifeSupportModule]]:FINAL
{
    @MODULE[KickLifeSupportModule]
    {
        avionicsEnabled = true
        avionicsECRate = 0.2
        avionicsHeat = 0.2
        sasECRate = 0.1
        sasHeat = 0.1
        rcsECRate = 0.1
        rcsHeat = 0.1
        // Fan and control electronics
        systemECRate = 0.03
        systemHeat = 0.03
        heaterECRate = 6.0
        heaterHeat = 6.0
    }
}

@PART[*]:HAS[@MODULE[ModuleCommand],#CrewCapacity[>3],@MODULE[KickLifeSupportModule]]:FINAL
{
    @MODULE[KickLifeSupportModule]
    {
        avionicsEnabled = true
        avionicsECRate = 0.2
        avionicsHeat = 0.2
        sasECRate = 0.1
        sasHeat = 0.1
        rcsECRate = 0.1
        rcsHeat = 0.1
        // Fan and control electronics
        systemECRate = 0.03
        heaterECRate = 8.0
        heaterHeat = 8.0
    }
}


// =========================================================
// LOGIC PATH A: REALFUELS IS PRESENT
// We inject TANK nodes into ModuleFuelTanks.
// =========================================================

// --- 1 CREW (RealFuels) ---
@PART[*]:HAS[#CrewCapacity[1],@MODULE[ModuleFuelTanks]]:FINAL
{
    @MODULE[ModuleFuelTanks]
    {
        @volume += 500
        TANK 
        {
            name = Oxygen           
            amount = full  
            maxAmount = 100 
        }
        TANK 
        {
            name = Food             
            amount = full  
            maxAmount = 1  
        }
        TANK 
        {
            name = Water            
            amount = full  
            maxAmount = 1  
        }
        TANK 
        {
            name = WasteWater       
            amount = 0.0   
            maxAmount = 1  
        }
        TANK 
        {
            name = Waste            
            amount = 0.0   
            maxAmount = 5  
        }
        TANK 
        { 
            name = LithiumHydroxide 
            amount = full  
            maxAmount = 0.5  
        }
    }
}

// --- 2 CREW (RealFuels) ---
@PART[*]:HAS[#CrewCapacity[2],@MODULE[ModuleFuelTanks]]:FINAL
{
    @MODULE[ModuleFuelTanks]
    {
        @volume += 1000
        TANK 
        {
            name = Oxygen           
            amount = full  
            maxAmount = 200 
        }
        TANK 
        {
            name = Food             
            amount = full  
            maxAmount = 2 
        }
        TANK 
        {
            name = Water            
            amount = full  
            maxAmount = 2 
        }
        TANK 
        {
            name = WasteWater       
            amount = 0.0   
            maxAmount = 2 
        }
        TANK 
        {
            name = Waste            
            amount = 0.0   
            maxAmount = 20 
        }
        TANK
        {
            name = LithiumHydroxide 
            amount = full  
            maxAmount = 0.5 
        }
    }
}

// --- 3 CREW (RealFuels) ---
@PART[*]:HAS[#CrewCapacity[3],@MODULE[ModuleFuelTanks]]:FINAL
{
    @MODULE[ModuleFuelTanks]
    {
        @volume += 1500
        TANK 
        {
            name = Oxygen           
            amount = full  
            maxAmount = 300 
        }
        TANK 
        {
            name = Food             
            amount = full  
            maxAmount = 3 
        }
        TANK 
        {
            name = Water            
            amount = full  
            maxAmount = 3 
        }
        TANK 
        {
            name = WasteWater       
            amount = 0.0   
            maxAmount = 3 
        }
        TANK 
        {
            name = Waste            
            amount = 0.0   
            maxAmount = 50 
        }
        TANK 
        {
            name = LithiumHydroxide 
            amount = full  
            maxAmount = 0.5 
        }
    }
}

// --- 4+ CREW (RealFuels) ---
// Using static values for 4 crew as a baseline for larger pods
@PART[*]:HAS[#CrewCapacity[>3],@MODULE[ModuleFuelTanks]]:FINAL
{
    @MODULE[ModuleFuelTanks]
    {
        @volume += 2000
        TANK 
        {
            name = Oxygen           
            amount = full  
            maxAmount = 400 
        }
        TANK 
        {
            name = Food             
            amount = full  
            maxAmount = 4 
        }
        TANK 
        {
            name = Water            
            amount = full  
            maxAmount = 4 
        }
        TANK 
        {
            name = WasteWater       
            amount = 0.0   
            maxAmount = 4 
        }
        TANK 
        {
            name = Waste            
            amount = 0.0   
            maxAmount = 50 
        }
        TANK 
        {
            name = LithiumHydroxide 
            amount = full  
            maxAmount = 0.5 
        }
    }
}

// =========================================================
// LOGIC PATH B: STOCK (NO REALFUELS)
// We add standard RESOURCE nodes.
// =========================================================

// --- 1 CREW (Stock) ---
@PART[*]:HAS[#CrewCapacity[1],!MODULE[ModuleFuelTanks]]:FINAL
{
    %RESOURCE[Oxygen]           
    {
        amount = 100  
        maxAmount = 100 
    }
    %RESOURCE[Food]             
    {
        amount = 1   
        maxAmount = 1
    }
    %RESOURCE[Water]            
    {
        amount = 1   
        maxAmount = 1  
    }
    %RESOURCE[WasteWater]       
    {
        amount = 0    
        maxAmount = 1  
    }
    %RESOURCE[Waste]            
    {
        amount = 0    
        maxAmount = 5  
    }
    %RESOURCE[LithiumHydroxide] 
    {
        amount = 1.5   
        maxAmount = 0.5  
    }
}

// --- 2 CREW (Stock) ---
@PART[*]:HAS[#CrewCapacity[2],!MODULE[ModuleFuelTanks]]:FINAL
{
    %RESOURCE[Oxygen]           
    {
        amount = 200  
        maxAmount = 200 
    }
    %RESOURCE[Food]             
    {
        amount = 2  
        maxAmount = 2 
    }
    %RESOURCE[Water]            
    {
        amount = 2  
        maxAmount = 2 
    }
    %RESOURCE[WasteWater]       
    {
        amount = 0    
        maxAmount = 2 
    }
    %RESOURCE[Waste]            
    {
        amount = 0    
        maxAmount = 20 
    }
    %RESOURCE[LithiumHydroxide] 
    {
        amount = 1.5  
        maxAmount = 0.5 
    }
}

// --- 3 CREW (Stock) ---
@PART[*]:HAS[#CrewCapacity[3],!MODULE[ModuleFuelTanks]]:FINAL
{
    %RESOURCE[Oxygen]           
    {
        amount = 300  
        maxAmount = 300 
    }
    %RESOURCE[Food]             
    {
        amount = 3  
        maxAmount = 3 
    }
    %RESOURCE[Water]            
    {
        amount = 3  
        maxAmount = 3 
    }
    %RESOURCE[WasteWater]       
    {
        amount = 0    
        maxAmount = 3 
    }
    %RESOURCE[Waste]            
    {
        amount = 0    
        maxAmount = 50 
    }
    %RESOURCE[LithiumHydroxide] 
    {
        amount = 1.5  
        maxAmount = 0.5 
    }
}

// --- 4+ CREW (Stock) ---
@PART[*]:HAS[#CrewCapacity[>3],!MODULE[ModuleFuelTanks]]:FINAL
{
    %RESOURCE[Oxygen]           
    {
        amount = 400  
        maxAmount = 400 
    }
    %RESOURCE[Food]             
    {
        amount = 4  
        maxAmount = 4 
    }
    %RESOURCE[Water]            
    {
        amount = 4  
        maxAmount = 4 
    }
    %RESOURCE[WasteWater]       
    {
        amount = 0    
        maxAmount = 4 
    }
    %RESOURCE[Waste]            
    {
        amount = 0    
        maxAmount = 50 
    }
    %RESOURCE[LithiumHydroxide] 
    {
        amount = 1.5  
        maxAmount = 0.5
    }
}

